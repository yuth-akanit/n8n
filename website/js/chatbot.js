/**
 * AI Chatbot Implementation
 * Provides customer support for AC & Freezer Services
 * Pre-programmed intents for quick response
 */

class ServiceChatbot {
  constructor() {
    this.container = document.querySelector('.chatbot-container');
    this.button = document.querySelector('.chatbot-button');
    this.window = document.querySelector('.chatbot-window');
    this.closeBtn = document.querySelector('.chatbot-close');
    this.messagesDiv = document.querySelector('.chatbot-messages');
    this.inputArea = document.querySelector('.chatbot-input-area');
    this.inputField = this.inputArea?.querySelector('input');
    this.sendBtn = this.inputArea?.querySelector('button');

    this.isOpen = false;
    this.messages = [];

    // Pre-programmed intents and responses
    this.intents = {
      greeting: {
        keywords: ['à¸ªà¸§à¸±à¸ªà¸”à¸µ', 'hi', 'hello', 'à¸‰à¸±à¸™', 'help', 'à¸Šà¹ˆà¸§à¸¢'],
        response: 'à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°! ðŸ‘‹ à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸ªà¸¹à¹ˆà¸šà¸£à¸´à¸à¸²à¸£ AC & Freezer à¸ªà¸¡à¸¸à¸—à¸£à¸›à¸£à¸²à¸à¸²à¸£\n\nà¸œà¸¡à¸ªà¸²à¸¡à¸²à¸£à¸–à¸Šà¹ˆà¸§à¸¢à¸„à¸¸à¸“à¹„à¸”à¹‰à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸­à¸°à¹„à¸£à¸šà¹‰à¸²à¸‡à¹€à¸«à¸£à¸­à¸„à¹ˆà¸°?\n\nâ€¢ ðŸ“‹ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸²à¸„à¸²\nâ€¢ ðŸ“ž à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢à¸Šà¹ˆà¸²à¸‡\nâ€¢ â“ à¸–à¸²à¸¡à¸›à¸±à¸à¸«à¸²à¹à¸­à¸£à¹Œ/à¸•à¸¹à¹‰à¹à¸Šà¹ˆ'
      },
      pricing: {
        keywords: ['à¸£à¸²à¸„à¸²', 'à¹€à¸—à¹ˆà¸²à¹„à¸£', 'à¹€à¸ªà¸µà¸¢à¸„à¹ˆà¸²à¹€à¸—à¹ˆà¸²à¹„à¸£', 'price', 'cost', 'à¸„à¹ˆà¸²à¸šà¸£à¸´à¸à¸²à¸£'],
        response: 'à¸„à¹ˆà¸²à¸šà¸£à¸´à¸à¸²à¸£à¸‚à¸­à¸‡à¹€à¸£à¸² ðŸ’°\n\nðŸ“Œ à¸¥à¹‰à¸²à¸‡à¹à¸­à¸£à¹Œ:\nâ€¢ à¸¥à¹‰à¸²à¸‡à¹à¸­à¸£à¹Œà¸ˆà¸²à¸à¸”à¹‰à¸²à¸™à¸«à¸™à¹‰à¸²: à¸¿800-1,200\nâ€¢ à¸¥à¹‰à¸²à¸‡à¹à¸­à¸£à¹Œà¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¸£à¸°à¸šà¸š: à¸¿2,500-4,000\n\nðŸ“Œ à¸‹à¹ˆà¸­à¸¡à¹à¸­à¸£à¹Œ:\nâ€¢ à¹€à¸Šà¹‡à¸„à¸›à¸±à¸à¸«à¸²: à¸¿400 (à¸Ÿà¸£à¸µà¸–à¹‰à¸²à¸ªà¸±à¹ˆà¸‡à¸‹à¹ˆà¸­à¸¡)\nâ€¢ à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡/à¹€à¸•à¸´à¸¡à¸™à¹‰à¸³à¸¢à¸²: à¸¿1,500-5,000\n\nðŸ“Œ à¸šà¸£à¸´à¸à¸²à¸£à¸•à¸¹à¹‰à¹à¸Šà¹ˆ:\nâ€¢ à¸¥à¹‰à¸²à¸‡à¸•à¸¹à¹‰à¹à¸Šà¹ˆ: à¸¿1,500-3,000\nâ€¢ à¸‹à¹ˆà¸­à¸¡/à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡: à¸•à¸²à¸¡à¹€à¸à¸ˆ\n\nâš ï¸ à¸£à¸²à¸„à¸²à¸­à¸²à¸ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸›à¸¥à¸‡ à¸à¸£à¸¸à¸“à¸²à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸žà¸·à¹ˆà¸­à¸¢à¸·à¸™à¸¢à¸±à¸™\n\nðŸ“ž à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢à¹„à¸«à¸¡à¸„à¹ˆà¸°?'
      },
      appointment: {
        keywords: ['à¸™à¸±à¸”', 'à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢', 'à¹„à¸›à¸–à¸¶à¸‡', 'à¹€à¸§à¸¥à¸²', 'à¸§à¸±à¸™', 'appointment', 'schedule', 'book'],
        response: 'à¸£à¸±à¸šà¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢ ðŸ“…\n\nà¸§à¸´à¸˜à¸µà¸™à¸±à¸”à¸«à¸¡à¸²à¸¢à¸Šà¹ˆà¸²à¸‡:\n1ï¸âƒ£ à¹‚à¸—à¸£à¸•à¸´à¸”à¸•à¹ˆà¸­: 089-xxx-xxxx (24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡)\n2ï¸âƒ£ à¹à¸Šà¸—à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸£à¸²: à¹ƒà¸Šà¹‰à¸›à¸¸à¹ˆà¸¡à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡\n3ï¸âƒ£ à¹à¸ˆà¹‰à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥:\n   - à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸šà¹‰à¸²à¸™ (à¸£à¸«à¸±à¸ªà¹„à¸›à¸£à¸©à¸“à¸µà¸¢à¹Œ)\n   - à¸›à¸±à¸à¸«à¸²/à¸šà¸£à¸´à¸à¸²à¸£à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£\n   - à¸§à¸±à¸™à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¸ªà¸°à¸”à¸§à¸\n\nâš¡ à¸Šà¹ˆà¸²à¸‡à¸¡à¸²à¸–à¸¶à¸‡à¸ à¸²à¸¢à¹ƒà¸™ 2-4 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡ (à¸Šà¹ˆà¸§à¸‡à¹€à¸Šà¹‰à¸²-à¸šà¹ˆà¸²à¸¢)\nðŸï¸ à¸§à¸±à¸™à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ-à¸§à¸±à¸™à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´: +500à¸¿ (à¸–à¹‰à¸²à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¸¡à¸²à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸ˆà¹ˆà¸²à¸¢à¹€à¸žà¸´à¹ˆà¸¡)\n\nðŸ› ï¸ à¸šà¸£à¸´à¸à¸²à¸£à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™à¸„à¹ˆà¸³-à¸à¸¥à¸²à¸‡à¸„à¸·à¸™: à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™ +1,000à¸¿'
      },
      problem_ac: {
        keywords: ['à¹à¸­à¸£à¹Œà¹„à¸¡à¹ˆà¹€à¸¢à¹‡à¸™', 'à¹„à¸¡à¹ˆà¹„à¸”à¹‰', 'à¹€à¸ªà¸µà¸¢', 'à¸¡à¸µà¸›à¸±à¸à¸«à¸²', 'air conditioner problem', 'ac broken', 'à¸•à¸´à¸”à¹†à¸”à¸±à¸šà¹†', 'à¸¥à¸¡', 'à¸‚à¸±à¸”', 'à¸™à¹‰à¸³à¸«à¸¢à¸”', 'à¸à¸¥à¸´à¹ˆà¸™à¸­à¸±à¸š', 'à¹€à¸ªà¸µà¸¢à¸‡à¹à¸›à¸¥à¸'],
        response: 'à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸›à¸±à¸à¸«à¸²à¹à¸­à¸£à¹Œ ðŸ”§\n\nâ“ à¹à¸­à¸£à¹Œà¸‚à¸­à¸‡à¸„à¸¸à¸“à¸¡à¸µà¸­à¸²à¸à¸²à¸£à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰à¹„à¸«à¸¡à¸„à¹ˆà¸°:\n\n1ï¸âƒ£ **à¹à¸­à¸£à¹Œà¹„à¸¡à¹ˆà¹€à¸¢à¹‡à¸™**\n   â†’ à¸•à¹‰à¸­à¸‡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š: à¸™à¹‰à¸³à¸¢à¸²à¹à¸­à¸£à¹Œ, à¸Ÿà¸´à¸¥à¹€à¸•à¸­à¸£à¹Œà¸ªà¸à¸›à¸£à¸, à¸„à¸­à¸¡à¹€à¸žà¸£à¸ªà¹€à¸‹à¸­à¸£à¹Œ\n\n2ï¸âƒ£ **à¸™à¹‰à¸³à¸«à¸¢à¸”à¹€à¸¢à¸­à¸°**\n   â†’ à¸ªà¸²à¹€à¸«à¸•à¸¸: à¸–à¸²à¸”à¸™à¹‰à¸³à¸­à¸¸à¸”à¸•à¸±à¸™, à¸—à¹ˆà¸­à¸£à¸°à¸šà¸²à¸¢à¸™à¹‰à¸³à¹€à¸ªà¸µà¸¢, à¸Ÿà¸´à¸¥à¹€à¸•à¸­à¸£à¹Œà¸ªà¸à¸›à¸£à¸\n\n3ï¸âƒ£ **à¸¡à¸µà¸à¸¥à¸´à¹ˆà¸™à¸­à¸±à¸š/à¹€à¸Šà¸·à¹‰à¸­à¸£à¸²**\n   â†’ à¸§à¸´à¸˜à¸µà¹à¸à¹‰à¹„à¸‚: à¸¥à¹‰à¸²à¸‡à¹à¸­à¸£à¹Œà¹€à¸•à¹‡à¸¡à¸£à¸°à¸šà¸š à¸¥à¹‰à¸²à¸‡à¸Ÿà¸´à¸¥à¹€à¸•à¸­à¸£à¹Œà¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹‰à¸­à¸¢ 1 à¹€à¸”à¸·à¸­à¸™à¸„à¸£à¸±à¹‰à¸‡\n\n4ï¸âƒ£ **à¸•à¸´à¸”à¹† à¸”à¸±à¸šà¹†**\n   â†’ à¸­à¸²à¸ˆà¹€à¸›à¹‡à¸™: à¹€à¸‹à¹‡à¸™à¹€à¸‹à¸­à¸£à¹Œà¹€à¸ªà¸µà¸¢, à¸Ÿà¸´à¸§à¸ªà¹Œà¸«à¸¥à¸§à¸¡, à¸›à¸±à¸à¸«à¸²à¹„à¸Ÿà¸Ÿà¹‰à¸²\n\n5ï¸âƒ£ **à¹€à¸ªà¸µà¸¢à¸‡à¹à¸›à¸¥à¸**\n   â†’ à¸•à¹‰à¸­à¸‡à¹€à¸Šà¹‡à¸„: à¸„à¸­à¸¡à¹€à¸žà¸£à¸ªà¹€à¸‹à¸­à¸£à¹Œ, à¸žà¸±à¸”à¸¥à¸¡, à¸ªà¸à¸£à¸¹à¸«à¸¥à¸§à¸¡\n\nðŸ’¡ **à¸›à¸£à¸¶à¸à¸©à¸²à¸Šà¹ˆà¸²à¸‡à¸—à¸±à¸™à¸—à¸µ**: à¹‚à¸—à¸£ 089-xxx-xxxx'
      },
      problem_freezer: {
        keywords: ['à¸•à¸¹à¹‰à¹à¸Šà¹ˆ', 'à¸•à¸¹à¹‰à¹€à¸¢à¹‡à¸™', 'freezer', 'cold storage', 'à¹„à¸¡à¹ˆà¹€à¸¢à¹‡à¸™', 'à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡', 'à¸›à¸£à¸°à¸•à¸¹à¸•à¸¹à¹‰à¹€à¸ªà¸µà¸¢', 'à¹€à¸ªà¸µà¸¢à¸‡', 'à¸›à¸±à¸à¸«à¸²'],
        response: 'à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸›à¸±à¸à¸«à¸²à¸•à¸¹à¹‰à¹à¸Šà¹ˆ/à¸•à¸¹à¹‰à¹€à¸¢à¹‡à¸™ ðŸ§Š\n\nâ“ à¸­à¸²à¸à¸²à¸£à¸•à¸¹à¹‰à¹à¸Šà¹ˆà¸‚à¸­à¸‡à¸„à¸¸à¸“:\n\n1ï¸âƒ£ **à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸¢à¹‡à¸™**\n   â†’ à¹€à¸Šà¹‡à¸„: à¸›à¸¥à¸±à¹Šà¸à¹„à¸Ÿ, à¸§à¸²à¸‡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡, à¸—à¹ˆà¸­à¸£à¸°à¸šà¸²à¸¢à¸„à¸§à¸²à¸¡à¸£à¹‰à¸­à¸™, à¸™à¹‰à¸³à¸¢à¸²à¸—à¸³à¸„à¸§à¸²à¸¡à¹€à¸¢à¹‡à¸™\n\n2ï¸âƒ£ **à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡à¹€à¸à¸²à¸°à¹€à¸¢à¸­à¸°**\n   â†’ à¸•à¹‰à¸­à¸‡à¸¥à¸°à¸¥à¸²à¸¢à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡ (*Defrost*) à¸—à¸¸à¸ 3-6 à¹€à¸”à¸·à¸­à¸™\n   â†’ à¸‚à¹‰à¸­à¸ªà¸±à¸‡à¹€à¸à¸•: à¹„à¸¡à¹ˆà¹€à¸›à¸´à¸”à¸›à¸£à¸°à¸•à¸¹à¸šà¹ˆà¸­à¸¢, à¸›à¸´à¸”à¸—à¹ˆà¸­à¸£à¸°à¸šà¸²à¸¢à¸­à¸²à¸à¸²à¸¨à¹ƒà¸«à¹‰à¸ªà¸™à¸´à¸—\n\n3ï¸âƒ£ **à¸›à¸£à¸°à¸•à¸¹à¸ªà¸±à¹ˆà¸™à¸«à¸¥à¸§à¸¡/à¸¢à¸²à¸‡à¹€à¸ªà¸µà¸¢**\n   â†’ à¸•à¹‰à¸­à¸‡à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸¢à¸²à¸‡à¸‹à¸µà¸¥, à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸•à¸±à¸§à¹à¸šà¸šà¸›à¸£à¸°à¸•à¸¹\n\n4ï¸âƒ£ **à¹€à¸ªà¸µà¸¢à¸‡à¸”à¸±à¸‡à¸œà¸´à¸”à¸›à¸à¸•à¸´**\n   â†’ à¸­à¸²à¸ˆà¹€à¸›à¹‡à¸™: à¸„à¸­à¸¡à¹€à¸žà¸£à¸ªà¹€à¸‹à¸­à¸£à¹Œà¸žà¸±à¸‡à¸ˆà¸³à¸«à¸¥à¸±à¸, à¸žà¸±à¸”à¸¥à¸¡à¹€à¸à¹ˆà¸², à¸—à¹ˆà¸­à¸œà¹ˆà¸­à¸™à¸„à¸¥à¸²à¸¢\n\n5ï¸âƒ£ **à¸­à¸²à¸«à¸²à¸£à¹„à¸¡à¹ˆà¸ªà¸”à¸«à¸£à¸·à¸­à¹€à¸ªà¸µà¸¢à¸‡**\n   â†’ à¸•à¸±à¹‰à¸‡à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´à¸—à¸µà¹ˆ -18Â°C, à¸«à¸¥à¸µà¸à¹€à¸¥à¸µà¹ˆà¸¢à¸‡à¹à¸”à¸”à¹€à¸žà¸£à¸²à¸°à¸—à¸³à¹ƒà¸«à¹‰à¸„à¸­à¸¡à¹€à¸žà¸£à¸ªà¹€à¸‹à¸­à¸£à¹Œà¸—à¸³à¸‡à¸²à¸™à¸«à¸™à¸±à¸\n\nðŸ› ï¸ **à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡**: à¸‹à¹ˆà¸­à¸¡à¸ˆà¹ˆà¸²à¸¢à¸„à¸§à¸²à¸¡à¹€à¸¢à¹‡à¸™ à¸¿2,500-5,000 (à¸•à¸²à¸¡à¸ªà¸²à¹€à¸«à¸•à¸¸)'
      },
      maintenance: {
        keywords: ['à¸”à¸¹à¹à¸¥', 'à¸šà¸³à¸£à¸¸à¸‡', 'à¸¥à¹‰à¸²à¸‡', 'maintenance', 'keep', 'à¸›à¹‰à¸­à¸‡à¸à¸±à¸™', 'preventive'],
        response: 'à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£à¹ƒà¸«à¹‰à¸™à¸²à¸™ âœ¨\n\nðŸ“Œ **à¸¥à¹‰à¸²à¸‡à¹à¸­à¸£à¹Œ** (à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¹€à¸Šà¸·à¹‰à¸­à¸£à¸²à¹à¸¥à¸°à¸›à¸£à¸°à¸«à¸¢à¸±à¸”à¹„à¸Ÿ):\nâ€¢ à¸¥à¹‰à¸²à¸‡à¸Ÿà¸´à¸¥à¹€à¸•à¸­à¸£à¹Œ: à¹€à¸”à¸·à¸­à¸™à¸¥à¸° 1 à¸„à¸£à¸±à¹‰à¸‡ (à¸”à¹‰à¸§à¸¢à¸™à¹‰à¸³à¸ªà¸šà¸¹à¹ˆ)\nâ€¢ à¸¥à¹‰à¸²à¸‡à¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¸£à¸°à¸šà¸š: 6 à¹€à¸”à¸·à¸­à¸™à¸•à¹ˆà¸­à¸„à¸£à¸±à¹‰à¸‡ à¸«à¸£à¸·à¸­ à¸›à¸µà¸¥à¸° 2 à¸„à¸£à¸±à¹‰à¸‡\nâ€¢ à¸”à¸¹à¹à¸¥à¹€à¸‚à¹‰à¸²à¸£à¸«à¸±à¸ªà¸—à¹ˆà¸­à¸£à¸°à¸šà¸²à¸¢à¸™à¹‰à¸³: à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸­à¸¸à¸”à¸•à¸±à¸™\n\nðŸ“Œ **à¸”à¸¹à¹à¸¥à¸•à¸¹à¹‰à¹à¸Šà¹ˆ/à¹€à¸¢à¹‡à¸™**:\nâ€¢ à¸•à¸±à¹‰à¸‡à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´ -18Â°C à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸¹à¹‰à¹à¸Šà¹ˆ à¹à¸¥à¹‰à¸§ -2Â°C à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸¹à¹‰à¹€à¸¢à¹‡à¸™\nâ€¢ à¸—à¸³à¸„à¸§à¸²à¸¡à¸ªà¸°à¸­à¸²à¸”à¸„à¸­à¸¢à¸¥à¹Œà¸£à¹‰à¸­à¸™: à¸›à¸µà¸¥à¸° 1-2 à¸„à¸£à¸±à¹‰à¸‡\nâ€¢ à¸¥à¸°à¸¥à¸²à¸¢à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡: à¸—à¸¸à¸ 3-6 à¹€à¸”à¸·à¸­à¸™ (à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µà¸£à¸°à¸šà¸š No-Frost)\nâ€¢ à¸›à¸´à¸”à¸›à¸£à¸°à¸•à¸¹à¹ƒà¸«à¹‰à¹à¸™à¹ˆà¸™ à¹€à¸Šà¹‡à¸„à¸¢à¸²à¸‡à¸›à¸£à¸°à¸•à¸¹\n\nâš¡ **à¹€à¸„à¸¥à¹‡à¸”à¸¥à¸±à¸šà¸›à¸£à¸°à¸«à¸¢à¸±à¸”à¹„à¸Ÿ**:\nâ€¢ à¸«à¸¥à¸µà¸à¹€à¸¥à¸µà¹ˆà¸¢à¸‡à¹à¸”à¸”à¹€à¸‚à¹‰à¸²à¸«à¹‰à¸­à¸‡ à¹ƒà¸Šà¹‰à¸¡à¹ˆà¸²à¸™à¸­à¸µà¸‹à¹ˆà¸²à¸«à¸£à¸·à¸­à¸Ÿà¸´à¸¥à¹Œà¸¡à¸à¸£à¸­à¸‡à¹à¸ªà¸‡\nâ€¢ à¹ƒà¸Šà¹‰à¸•à¸±à¸§à¸›à¸£à¸±à¸šà¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´à¸­à¸±à¸ˆà¸‰à¸£à¸´à¸¢à¸° (Smart Thermostat)\nâ€¢ à¸›à¸¥à¸²à¸¢à¸™à¹‰à¸³: à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹à¸­à¸£à¹Œà¸¢à¸²à¸¡à¸„à¹ˆà¸³à¸«à¸£à¸·à¸­ à¸•à¸±à¹‰à¸‡à¸­à¸¸à¸“à¸«à¸ à¸¹à¸¡à¸´à¸ªà¸¹à¸‡à¸‚à¸¶à¹‰à¸™à¹„à¸› 1-2 à¸­à¸‡à¸¨à¸²\n\nðŸ“… **à¸›à¸´à¸”/à¸‹à¸±à¸à¹à¸­à¸£à¹Œ**: à¸«à¸™à¹‰à¸²à¸£à¹‰à¸­à¸™(à¸¡à¸µ-à¸žà¸„) à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¸¥à¹‰à¸²à¸‡, à¸«à¸™à¹‰à¸²à¸à¸™(à¸¡à¸´-à¸•à¸„) à¹€à¸Šà¹‡à¸„à¸«à¸¥à¸±à¸‡à¸à¸™à¸•à¸'
      },
      contact: {
        keywords: ['à¸•à¸´à¸”à¸•à¹ˆà¸­', 'à¹€à¸šà¸­à¸£à¹Œ', 'à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£', 'à¹€à¸šà¸­à¸£à¹Œà¸•à¸´à¸”à¸•à¹ˆà¸­', 'contact', 'phone', 'facebook', 'line'],
        response: 'à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸£à¸² ðŸ“ž\n\nâ˜Žï¸ **à¹‚à¸—à¸£à¸¨à¸±à¸žà¸—à¹Œ**: 089-xxx-xxxx (24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡)\nðŸ“ **à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ**: à¸ªà¸¡à¸¸à¸—à¸£à¸›à¸£à¸²à¸à¸²à¸£ (à¸šà¸£à¸´à¸à¸²à¸£à¸—à¸±à¹ˆà¸§ 6 à¸­à¸³à¹€à¸ à¸­)\nðŸ“§ **à¸­à¸µà¹€à¸¡à¸¥**: info@acrfreezer-smp.com\n\nðŸ’¬ **à¸Šà¹ˆà¸­à¸‡à¸—à¸²à¸‡à¸­à¸·à¹ˆà¸™**:\nðŸ“± Line: @acrfreezer\nðŸ“˜ Facebook: AC & Freezer Service Samut Prakan\nðŸ• **à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£**: à¸§à¸±à¸™à¸ˆà¸±à¸™à¸—à¸£à¹Œ-à¹€à¸ªà¸²à¸£à¹Œ 8:00-18:00\n                  à¸§à¸±à¸™à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ: 8:00-17:00\nâš¡ **à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™**: 24 à¸Šà¸¡. (à¸¡à¸µà¹ˆà¸à¸µà¹ˆà¸„à¸™)\n\nðŸ’³ **à¸Šà¹ˆà¸­à¸‡à¸—à¸²à¸‡à¸à¸²à¸£à¸Šà¸³à¸£à¸°**:\nâ€¢ à¹€à¸‡à¸´à¸™à¸ªà¸” (à¸šà¹‰à¸²à¸™)\nâ€¢ à¹‚à¸­à¸™à¸˜à¸™à¸²à¸„à¸²à¸£\nâ€¢ QR Code (PromptPay)\n\nðŸŽ **à¸ªà¸´à¸—à¸˜à¸´à¸žà¸´à¹€à¸¨à¸©**:\nâ€¢ à¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ: à¸ªà¹ˆà¸§à¸™à¸¥à¸” 5% (à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸)\nâ€¢ à¸ˆà¸­à¸‡à¸šà¸£à¸´à¸à¸²à¸£ 3 à¸„à¸£à¸±à¹‰à¸‡à¸‚à¸¶à¹‰à¸™à¹„à¸›: à¸Ÿà¸£à¸µ 1 à¸„à¸£à¸±à¹‰à¸‡'
      },
      hours: {
        keywords: ['à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£', 'à¸§à¸±à¸™à¹€à¸›à¸´à¸”', 'à¹€à¸›à¸´à¸”à¸à¸µà¹ˆà¹‚à¸¡à¸‡', 'à¸›à¸´à¸”à¸à¸µà¹ˆà¹‚à¸¡à¸‡', 'opening hours', 'working hours'],
        response: 'à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£ ðŸ•\n\nðŸ“… **à¸§à¸±à¸™à¸ˆà¸±à¸™à¸—à¸£à¹Œ-à¸¨à¸¸à¸à¸£à¹Œ**:\nðŸ•— 08:00 - 18:00\n\nðŸ“… **à¸§à¸±à¸™à¹€à¸ªà¸²à¸£à¹Œ**:\nðŸ•— 08:00 - 18:00 (à¸­à¸²à¸ˆà¸¡à¸µà¸«à¸¢à¸¸à¸”à¸à¸¥à¸²à¸‡à¸§à¸±à¸™ 12:00-13:00)\n\nðŸ“… **à¸§à¸±à¸™à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ & à¸§à¸±à¸™à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´**:\nðŸ•— 08:00 - 17:00 (à¸«à¸£à¸·à¸­à¸«à¸¢à¸¸à¸”à¸‚à¸¶à¹‰à¸™à¸­à¸¢à¸¹à¹ˆà¸à¸±à¸šà¹€à¸«à¸•à¸¸à¸à¸²à¸£à¸“à¹Œ)\n\nâš¡ **à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™ 24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡**:\nâ€¢ à¹„à¸Ÿà¸”à¸±à¸šà¹à¸¥à¹‰à¸§à¸—à¸³à¸„à¸§à¸²à¸¡à¹€à¸¢à¹‡à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰\nâ€¢ à¸•à¸¹à¹‰à¹€à¸¢à¹‡à¸™à¹€à¸ªà¸µà¸¢\nâ€¢ à¹‚à¸—à¸£à¹à¸ˆà¹‰à¸‡: 089-xxx-xxxx (+à¸„à¹ˆà¸²à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™ à¸¿1,000)'
      },
      warranty: {
        keywords: ['à¸›à¸£à¸°à¸à¸±à¸™', 'à¸£à¸±à¸šà¸›à¸£à¸°à¸à¸±à¸™', 'warranty', 'guarantee', 'guarantee period'],
        response: 'à¸™à¹‚à¸¢à¸šà¸²à¸¢à¸›à¸£à¸°à¸à¸±à¸™ âœ…\n\nðŸ›¡ï¸ **à¸›à¸£à¸°à¸à¸±à¸™à¸‹à¹ˆà¸­à¸¡**: 30 à¸§à¸±à¸™\nâ€¢ à¸–à¹‰à¸²à¸‹à¹ˆà¸­à¸¡à¹à¸¥à¹‰à¸§à¹à¸­à¸£à¹Œà¹€à¸ªà¸µà¸¢à¹ƒà¸ˆ â†’ à¸‹à¹ˆà¸­à¸¡à¹ƒà¸«à¸¡à¹ˆà¸Ÿà¸£à¸µ\n\nðŸ›¡ï¸ **à¸›à¸£à¸°à¸à¸±à¸™à¸­à¸°à¹„à¸«à¸¥à¹ˆ**: à¸•à¸²à¸¡à¸à¸³à¸«à¸™à¸”à¸‚à¸­à¸‡à¸­à¸°à¹„à¸«à¸¥à¹ˆ\nâ€¢ à¸­à¸°à¹„à¸«à¸¥à¹ˆà¹à¸—à¹‰: 1-3 à¸›à¸µ\nâ€¢ à¸­à¸°à¹„à¸«à¸¥à¹ˆà¸—à¸±à¹ˆà¸§à¹„à¸›: 6 à¹€à¸”à¸·à¸­à¸™ - 1 à¸›à¸µ\n\nâš ï¸ **à¹„à¸¡à¹ˆà¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡**:\nâ€¢ à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸ˆà¸²à¸à¸ à¸±à¸¢à¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´ (à¸™à¹‰à¸³à¸—à¹ˆà¸§à¸¡, à¸Ÿà¹‰à¸²à¸œà¹ˆà¸²)\nâ€¢ à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡\nâ€¢ à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚à¸«à¸£à¸·à¸­à¸à¸²à¸£à¸–à¸­à¸”à¸›à¸°à¹à¸à¸°à¹‚à¸”à¸¢à¸šà¸¸à¸„à¸„à¸¥à¸­à¸·à¹ˆà¸™\n\nðŸ“ **à¹€à¸­à¸à¸ªà¸²à¸£à¸›à¸£à¸°à¸à¸±à¸™**:\nâ€¢ à¸­à¸­à¸à¹ƒà¸šà¸à¸²à¸£à¸“à¹Œà¹ƒà¸«à¹‰à¹€à¸¡à¸·à¹ˆà¸­à¸‹à¹ˆà¸­à¸¡à¹€à¸ªà¸£à¹‡à¸ˆ\nâ€¢ à¹€à¸à¹‡à¸šà¹ƒà¸šà¸à¸²à¸£à¸“à¹Œà¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸à¸£à¹‰à¸­à¸‡à¸„à¹ˆà¸²à¸›à¸£à¸°à¸à¸±à¸™\n\nâ“ **à¸¡à¸µà¸„à¸³à¸–à¸²à¸¡à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¹„à¸«à¸¡à¸„à¹ˆà¸°?**'
      },
      other: {
        keywords: [],
        response: 'à¸‚à¸­à¹‚à¸—à¸©à¸„à¹ˆà¸° ðŸ™ à¹„à¸¡à¹ˆà¸„à¹ˆà¸­à¸¢à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸„à¸³à¸–à¸²à¸¡\n\nà¸Šà¹ˆà¸§à¸¢à¸¥à¸­à¸‡à¹€à¸‚à¸µà¸¢à¸™à¹ƒà¸«à¸¡à¹ˆà¹„à¸”à¹‰à¹„à¸«à¸¡à¸„à¹ˆà¸° à¸«à¸£à¸·à¸­à¹€à¸¥à¸·à¸­à¸à¸ˆà¸²à¸à¸«à¸±à¸§à¸‚à¹‰à¸­à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰:\n\nâ€¢ ðŸ“‹ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸²à¸„à¸²\nâ€¢ ðŸ“ž à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢à¸Šà¹ˆà¸²à¸‡\nâ€¢ ðŸ”§ à¸›à¸±à¸à¸«à¸²à¹à¸­à¸£à¹Œ\nâ€¢ ðŸ§Š à¸›à¸±à¸à¸«à¸²à¸•à¸¹à¹‰à¹à¸Šà¹ˆ\nâ€¢ âœ¨ à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²\nâ€¢ ðŸ“ž à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸£à¸²\nâ€¢ ðŸ• à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£\nâ€¢ âœ… à¸›à¸£à¸°à¸à¸±à¸™\n\nà¸«à¸£à¸·à¸­à¸ˆà¸°à¹‚à¸—à¸£: 089-xxx-xxxx à¹€à¸¥à¸¢à¸à¹‡à¹„à¸”à¹‰à¸™à¸°à¸„à¹ˆà¸°!'
      }
    };

    this.init();
  }

  init() {
    if (!this.button) return;

    this.button.addEventListener('click', () => this.toggleWindow());
    if (this.closeBtn) this.closeBtn.addEventListener('click', () => this.closeWindow());
    if (this.sendBtn) this.sendBtn.addEventListener('click', () => this.sendMessage());
    if (this.inputField) {
      this.inputField.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') this.sendMessage();
      });
    }

    // Initial greeting
    this.addBotMessage('à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°! ðŸ‘‹ à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸ªà¸¹à¹ˆà¸šà¸£à¸´à¸à¸²à¸£ AC & Freezer à¸ªà¸¡à¸¸à¸—à¸£à¸›à¸£à¸²à¸à¸²à¸£\n\nà¸œà¸¡à¸ªà¸²à¸¡à¸²à¸£à¸–à¸Šà¹ˆà¸§à¸¢à¸„à¸¸à¸“à¹„à¸”à¹‰à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸­à¸°à¹„à¸£à¸šà¹‰à¸²à¸‡à¹€à¸«à¸£à¸­à¸„à¹ˆà¸°?\n\nâ€¢ ðŸ“‹ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸²à¸„à¸²\nâ€¢ ðŸ“ž à¸™à¸±à¸”à¸«à¸¡à¸²à¸¢à¸Šà¹ˆà¸²à¸‡\nâ€¢ ðŸ”§ à¸›à¸±à¸à¸«à¸²à¹à¸­à¸£à¹Œ\nâ€¢ ðŸ§Š à¸›à¸±à¸à¸«à¸²à¸•à¸¹à¹‰à¹à¸Šà¹ˆ\nâ€¢ âœ¨ à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²\nâ€¢ ðŸ“ž à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸£à¸²\nâ€¢ ðŸ• à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£\nâ€¢ âœ… à¸›à¸£à¸°à¸à¸±à¸™');
  }

  toggleWindow() {
    if (this.isOpen) {
      this.closeWindow();
    } else {
      this.openWindow();
    }
  }

  openWindow() {
    if (this.window) {
      this.window.classList.add('active');
      this.isOpen = true;
      if (this.inputField) this.inputField.focus();
    }
  }

  closeWindow() {
    if (this.window) {
      this.window.classList.remove('active');
      this.isOpen = false;
    }
  }

  sendMessage() {
    const message = this.inputField?.value.trim();
    if (!message) return;

    // Add user message
    this.addUserMessage(message);
    if (this.inputField) this.inputField.value = '';

    // Process and respond
    setTimeout(() => this.processMessage(message), 300);
  }

  addUserMessage(text) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message user';
    messageDiv.innerHTML = `<div class="chat-bubble">${this.escapeHtml(text)}</div>`;
    this.messagesDiv?.appendChild(messageDiv);
    this.scrollToBottom();
  }

  addBotMessage(text) {
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message bot';
    messageDiv.innerHTML = `<div class="chat-bubble">${text}</div>`;
    this.messagesDiv?.appendChild(messageDiv);
    this.scrollToBottom();
  }

  processMessage(userInput) {
    const input = userInput.toLowerCase();
    let response = this.intents.other.response;

    // Check for intent matches
    for (const [key, intent] of Object.entries(this.intents)) {
      if (key === 'other') continue;
      if (intent.keywords.some(keyword => input.includes(keyword))) {
        response = intent.response;
        break;
      }
    }

    this.addBotMessage(response);
  }

  scrollToBottom() {
    if (this.messagesDiv) {
      setTimeout(() => {
        this.messagesDiv.scrollTop = this.messagesDiv.scrollHeight;
      }, 100);
    }
  }

  escapeHtml(text) {
    const map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
  }
}

// Initialize chatbot when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
  new ServiceChatbot();
});
