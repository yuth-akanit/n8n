{"name": "สร้าง_Animation","nodes": [{"parameters": {"promptType": "define","text": "=สร้างหนังเกี่ยวกับจากเนื้อหานี้ \"{{ $json.text }}\"  จำนวน 2 ฉากต่อเนื่องกัน และเลือกเสียงพากย์ที่เหมาะสมและ Speed, Vol และ Pitch.","hasOutputParser": true,"options": {"systemMessage": "=You are an AI assistant that generates voice synthesis configurations for animated story scenes. When a user requests an animated film with a specific number of scenes, generate a complete JSON array with voice configurations for ALL scenes.\n\nOUTPUT FORMAT:\nGenerate a JSON array with the EXACT number of scenes requested. Each scene contains one voice configuration with narration text that tells the complete story from beginning to end.\n\nSTRUCTURE:\n[\n  {\n    \"scene_number\": 1,\n    \"scene_title\": \"[Scene Title]\",\n    \"scene_description\": \"[What happens in this scene]\",\n    \"text\": \"[Complete narration text for this scene]\",\n    \"voice_setting\": {\n      \"speed\": 1.0,\n      \"vol\": 1.0,\n      \"voice_id\": \"[select from available voices]\",\n      \"pitch\": 0,\n      \"english_normalization\": false\n    },\n    \"output_format\": \"hex\",\n    \"audio_setting\": {\n      \"sample_rate\": 44100,\n      \"bitrate\": 256000,\n      \"channel\": 2\n    },\n    \"language_boost\": \"[detected language]\"\n  }\n]\n\nAVAILABLE VOICES:\n- Wise_Woman - Mature female (narrators, mentors)\n- Friendly_Person - Warm neutral (companions)\n- Inspirational_Girl - Uplifting young female (heroines)\n- Deep_Voice_Man - Rich male (authority, villains)\n- Calm_Woman - Serene female (healers, peaceful characters)\n- Casual_Guy - Relaxed male (sidekicks, comic relief)\n- Lively_Girl - Energetic young female (playful characters)\n- Patient_Man - Steady male (teachers, guides)\n- Young_Knight - Noble young male (heroes, warriors)\n- Determined_Man - Strong-willed male (leaders)\n- Lovely_Girl - Sweet young female (princesses)\n- Decent_Boy - Polite young male (young heroes)\n- Imposing_Manner - Commanding (kings, powerful beings)\n- Elegant_Man - Refined male (nobles, scholars)\n- Abbess - Spiritual female (religious figures)\n- Sweet_Girl_2 - Gentle young female (innocent characters)\n- Exuberant_Girl - Enthusiastic young female (joyful scenes)\n\nVOICE PARAMETERS:\n- speed: 0.5-2.0 (default: 1.0)\n- vol: 0.1-2.0 (default: 1.0)\n- pitch: -12 to +12 semitones (default: 0)\n\nEMOTIONAL ADJUSTMENTS:\n- Happy: speed 1.1-1.2, pitch +1 to +3, vol 1.1\n- Sad: speed 0.8-0.9, pitch -2 to 0, vol 0.9\n- Angry: speed 1.2-1.4, pitch +2 to +4, vol 1.3-1.5\n- Fearful: speed 1.3-1.5, pitch +3 to +5, vol 0.8-1.0\n- Calm: speed 0.9-1.0, pitch -1 to +1, vol 1.0\n- Excited: speed 1.2-1.3, pitch +2 to +4, vol 1.2\n\nGENERATION RULES:\n\n1. Extract from user request:\n   - Story topic\n   - Exact number of scenes\n   - Target language\n\n2. Create complete story outline:\n   - Divide into requested number of scenes\n   - Ensure beginning, middle, and end\n   - Each scene advances the plot\n\n3. Generate ALL scenes (1 to N):\n   - Sequential scene numbers\n   - Real titles and descriptions (no placeholders)\n   - Narration text: 100-300 characters per scene\n   - Choose appropriate voice and adjust parameters\n   - Set language_boost to detected language\n\n4. Story structure (example for 20 scenes):\n   - Scenes 1-3: Introduction\n   - Scenes 4-7: Rising action\n   - Scenes 8-12: Development\n   - Scenes 13-16: Climax\n   - Scenes 17-19: Falling action\n   - Scene 20: Conclusion\n\n5. Narration guidelines:\n   - Use storytelling style with vivid descriptions\n   - Include actions, emotions, dialogue\n   - Make scenes self-contained but connected\n   - Maintain story continuity\n\nOUTPUT REQUIREMENTS:\n- Output ONLY valid JSON array\n- NO markdown code blocks, NO explanations\n- Generate ALL requested scenes with real content\n- Proper JSON syntax throughout"}},"type": "@n8n/n8n-nodes-langchain.agent","typeVersion": 2.2,"position": [176, 308],"id": "155ca7a1-63c9-4778-be96-0f38144f69f1","name": "AI Agent"},{"parameters": {"model": "openai/gpt-oss-120b","options": {}},"type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion": 1,"position": [-104, 532],"id": "99594023-77d1-4a1c-9b58-5cdef1fc1f20","name": "OpenRouter Chat Model","credentials": {"openRouterApi": {"id": "cWVU1UxXxfXEKfm8","name": "GPT5"}}},{"parameters": {"rule": {"interval": [{"triggerAtHour": 10}]}},"type": "n8n-nodes-base.scheduleTrigger","typeVersion": 1.2,"position": [-400, 308],"id": "cf3e52b5-a40d-4fb9-9904-c95264b75971","name": "Schedule Trigger"},{"parameters": {"jsonSchemaExample": "[\n{\n    \"scene_number\": 1,\n    \"scene_title\": \"จุดเริ่มต้นของเรื่องราว\",\n    \"scene_description\": \"เปิดเรื่องด้วยการแนะนำพระราชาและพระราชโอรสทั้งสอง\",\n    \"text\": \"ณ กรุงรัตนบุรี มีพระราชาองค์หนึ่งทรงมีพระราชโอรสสองพระองค์ คือ พระอภัยมณีและพระศรีสุวรรณ พระราชาทรงประสงค์ให้พระราชโอรสทั้งสองเรียนรู้วิชาที่มีประโยชน์ต่อราชอาณาจักร\",\n    \"voice_setting\": {\n      \"speed\": 1,\n      \"vol\": 1,\n      \"voice_id\": \"Wise_Woman\",\n      \"pitch\": 0,\n      \"english_normalization\": false\n    },\n    \"output_format\": \"hex\",\n    \"audio_setting\": {\n      \"sample_rate\": 44100,\n      \"bitrate\": 256000,\n      \"channel\": 2\n    },\n    \"language_boost\": \"Thai\"\n  },\n  {\n    \"scene_number\": 2,\n    \"scene_title\": \"การเรียนรู้วิชาความรู้\",\n    \"scene_description\": \"พระอภัยมณีเรียนเป่าขลุ่ย ส่วนพระศรีสุวรรณเรียนวิชาการต่อสู้\",\n    \"text\": \"พระอภัยมณีเลือกเรียนวิชาการเป่าขลุ่ยวิเศษ ขณะที่พระศรีสุวรรณเลือกเรียนวิชาการต่อสู้ด้วยดาบ พระราชาทรงไม่พอพระทัยที่พระอภัยมณีเลือกเรียนวิชาที่ไม่เป็นประโยชน์ต่อการปกครองบ้านเมือง\",\n    \"voice_setting\": {\n      \"speed\": 1,\n      \"vol\": 1,\n      \"voice_id\": \"Wise_Woman\",\n      \"pitch\": 0,\n      \"english_normalization\": false\n    },\n    \"output_format\": \"hex\",\n    \"audio_setting\": {\n      \"sample_rate\": 44100,\n      \"bitrate\": 256000,\n      \"channel\": 2\n    },\n    \"language_boost\": \"Thai\"\n  },\n  {\n    \"scene_number\": 3,\n    \"scene_title\": \"การถูกเนรเทศ\",\n    \"scene_description\": \"พระราชาทรงโกรธและเนรเทศพระราชโอรสทั้งสองออกจากเมือง\",\n    \"text\": \"เมื่อพระราชาทรงทราบว่าพระอภัยมณีเรียนเพียงการเป่าขลุ่ย พระองค์ทรงกริ้วมาก จึงมีพระราชโองการให้เนรเทศพระราชโอรสทั้งสองออกจากกรุงรัตนบุรี พระอภัยมณีและพระศรีสุวรรณจึงต้องออกเดินทางด้วยความเศร้าโศก\",\n    \"voice_setting\": {\n      \"speed\": 0.9,\n      \"vol\": 1,\n      \"voice_id\": \"Wise_Woman\",\n      \"pitch\": -1,\n      \"english_normalization\": false\n    },\n    \"output_format\": \"hex\",\n    \"audio_setting\": {\n      \"sample_rate\": 44100,\n      \"bitrate\": 256000,\n      \"channel\": 2\n    },\n    \"language_boost\": \"Thai\"\n  }\n]"}},"type": "@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion": 1.3,"position": [248, 532],"id": "2a380692-e738-4da5-8206-3a37e3184b9c","name": "Structured Output Parser"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/ffmpeg-api/merge-videos","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","sendBody": true,"specifyBody": "json","jsonBody": "={\n  \"video_urls\": {{ JSON.stringify($json.video_urls || []) }}\n}","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [1648, -8],"id": "91e77a2c-1512-4469-b308-4f4bb0a68765","name": "HTTP Request6","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {},"type": "n8n-nodes-base.wait","typeVersion": 1.1,"position": [1872, -8],"id": "faadfc5b-c3a4-490d-bb85-a42fd3c6647e","name": "Wait6","webhookId": "80244780-c89d-4eb2-b367-66d848d9fcd2"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}/status ","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [2096, -80],"id": "cbb032da-ce34-4486-9db7-b3da531110a0","name": "HTTP Request7","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"conditions": {"options": {"caseSensitive": true,"leftValue": "","typeValidation": "strict","version": 2},"conditions": [{"id": "34aa2d18-8f01-404d-8bd4-5299704f1729","leftValue": "={{ $json.status }}","rightValue": "COMPLETED","operator": {"type": "string","operation": "equals","name": "filter.operator.equals"}}],"combinator": "and"},"options": {}},"type": "n8n-nodes-base.if","typeVersion": 2.2,"position": [2384, -8],"id": "9ad28bc9-6f26-426c-a81c-a4cd3e1c7039","name": "If2"},{"parameters": {"documentId": {"__rl": true,"value": "1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk","mode": "list","cachedResultName": "สำเนาของ n8n animation production PAA","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit?usp=drivesdk"},"sheetName": {"__rl": true,"value": 113471321,"mode": "list","cachedResultName": "Sheet1","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit#gid=113471321"},"filtersUI": {"values": [{"lookupColumn": "status","lookupValue": "pending"}]},"options": {}},"type": "n8n-nodes-base.googleSheets","typeVersion": 4.7,"position": [1200, -8],"id": "89d135f1-3726-4f22-901a-1a1869712874","name": "Get row(s) in sheet2","credentials": {"googleSheetsOAuth2Api": {"id": "tJDzYUzM2DzwU6Fo","name": "Google Sheets account"}}},{"parameters": {"jsCode": "const videoUrls = $input.all().map(item => item.json.video_audio);\n\n// Return as a single item with the array\nreturn [\n  {\n    json: {\n      video_urls: videoUrls\n    }\n  }\n];"},"type": "n8n-nodes-base.code","typeVersion": 2,"position": [1424, -8],"id": "958cd50b-e028-4911-a2b4-23bebfd7c644","name": "Code in JavaScript1"},{"parameters": {},"type": "n8n-nodes-base.limit","typeVersion": 1,"position": [976, -8],"id": "7a22e98b-c197-4a0e-af46-d675ae66999c","name": "Limit"},{"parameters": {"url": "={{ $('HTTP Request11').item.json.video.url }}","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [3568, -8],"id": "a461217b-6726-4706-8337-0805b9c8a263","name": "HTTP Request12"},{"parameters": {"content": "# ดาวน์โหลดเพลง และ อัพโหลด","height": 336,"width": 320,"color": 7},"type": "n8n-nodes-base.stickyNote","typeVersion": 1,"position": [3232, -184],"id": "65c1a3a8-76e5-4ea3-9e15-fe7f3429f49d","name": "Sticky Note7"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [2672, -8],"id": "4255b1a8-aa68-49d3-9da9-4772736c4359","name": "HTTP Request11","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"method": "POST","url": "https://queue.fal.run/fal-ai/minimax/preview/speech-2.5-turbo","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","sendBody": true,"specifyBody": "json","jsonBody": "={\n  \"text\": {{ JSON.stringify($json.text) }},\n  \"voice_setting\": {\n    \"speed\": {{ $json.voice_setting.speed }},\n    \"vol\": {{ $json.voice_setting.vol }},\n    \"voice_id\": \"Elegant_Man\",\n    \"pitch\": {{ $json.voice_setting.pitch }},\n    \"english_normalization\": {{ $json.voice_setting.english_normalization }}\n  },\n  \"output_format\": \"{{ $json.output_format }}\",\n  \"audio_setting\": {\n    \"sample_rate\": {{ $json.audio_setting.sample_rate }},\n    \"bitrate\": {{ $json.audio_setting.bitrate }},\n    \"channel\": {{ $json.audio_setting.channel }}\n  },\n  \"language_boost\": \"Thai\"\n}","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [976, 308],"id": "83d33e9d-fd34-4cfd-8a39-25b5f146897e","name": "HTTP Request","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"options": {}},"type": "n8n-nodes-base.splitInBatches","typeVersion": 3,"position": [752, 308],"id": "c09c6223-0233-4a0e-b62c-648857694c04","name": "Loop Over Items1"},{"parameters": {},"type": "n8n-nodes-base.wait","typeVersion": 1.1,"position": [1200, 308],"id": "97bf2a2c-4bc5-4df4-aa2c-d50e46dcaaae","name": "Wait","webhookId": "b5115d25-9016-4796-a04a-0833d42f7f6f"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/minimax/requests/{{ $json.request_id }}","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [1424, 236],"id": "03274374-5bcc-41b5-b961-f0bfc8c27f20","name": "HTTP Request13","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"conditions": {"options": {"caseSensitive": true,"leftValue": "","typeValidation": "strict","version": 2},"conditions": [{"id": "34aa2d18-8f01-404d-8bd4-5299704f1729","leftValue": "={{ $json.status }}","rightValue": "COMPLETED","operator": {"type": "string","operation": "equals","name": "filter.operator.equals"}}],"combinator": "and"},"options": {}},"type": "n8n-nodes-base.if","typeVersion": 2.2,"position": [1648, 308],"id": "257a8e06-9fca-45ef-9b73-6bcd5e61cf3f","name": "If3"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/minimax/requests/{{ $json.request_id }}","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [1872, 308],"id": "23c15317-6b72-4115-82bb-146ade8f719b","name": "HTTP Request14","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"operation": "append","documentId": {"__rl": true,"value": "1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk","mode": "list","cachedResultName": "สำเนาของ n8n animation production PAA","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit?usp=drivesdk"},"sheetName": {"__rl": true,"value": 113471321,"mode": "list","cachedResultName": "Sheet1","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit#gid=113471321"},"columns": {"mappingMode": "defineBelow","value": {"audio": "={{ $json.audio.url }}"},"matchingColumns": [],"schema": [{"id": "audio","displayName": "audio","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true},{"id": "video","displayName": "video","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true},{"id": "video_audio","displayName": "video_audio","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true},{"id": "status","displayName": "status","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true},{"id": "title","displayName": "title","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true},{"id": "desciption ","displayName": "desciption ","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true},{"id": "Final","displayName": "Final","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": true}]},"attemptToConvertTypes": false,"convertFieldsToString": false},"options": {}},"type": "n8n-nodes-base.googleSheets","typeVersion": 4.7,"position": [2096, 308],"id": "5abbe36f-5b8c-4618-a4f9-6ceb8d942086","name": "Append row in sheet1","credentials": {"googleSheetsOAuth2Api": {"id": "tJDzYUzM2DzwU6Fo","name": "Google Sheets account"}}},{"parameters": {"url": "https://api.kie.ai/api/v1/jobs/recordInfo","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","sendQuery": true,"queryParameters": {"parameters": [{"name": "code","value": "200"},{"name": "msg","value": "success"},{"name": "taskId","value": "e5a012858760ff1acbd7150bce9264ee"},{"name": "recordId","value": "e5a012858760ff1acbd7150bce9264ee"}]},"sendHeaders": true,"headerParameters": {"parameters": [{"name": "Authorization","value": "Bearer 2d15ec6fefb8bda6d73fc5b7f7857b13"}]},"options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [2672, 308],"id": "e185c6a3-c97e-4b45-9beb-c88dde5bdd77","name": "HTTP Request1","credentials": {"httpHeaderAuth": {"id": "vHuywDuJta0UDSgK","name": "kie.ai"}}},{"parameters": {},"type": "n8n-nodes-base.wait","typeVersion": 1.1,"position": [2896, 308],"id": "1641eb56-8136-4662-812a-a43821e2d7bd","name": "Wait3","webhookId": "1a6efaa4-4c58-4e0d-8830-49db6473fe3d"},{"parameters": {"url": "https://api.kie.ai/api/v1/jobs/recordInfo","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","sendQuery": true,"queryParameters": {"parameters": [{"name": "taskId","value": "={{ $json.data.taskId }}"]}},"options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [3120, 236],"id": "9324a743-996e-4d6b-b4c8-495afb6e0b42","name": "HTTP Request15","credentials": {"httpHeaderAuth": {"id": "vHuywDuJta0UDSgK","name": "kie.ai"}}},{"parameters": {"rules": {"values": [{"conditions": {"options": {"caseSensitive": true,"leftValue": "","typeValidation": "strict","version": 2},"conditions": [{"leftValue": "success","rightValue": "={{ $json.data.state }}","operator": {"type": "string","operation": "equals"},"id": "0a0810fe-5559-499c-88fa-ef9319fbaa08"}]},"combinator": "and","renameOutput": true,"outputKey": "success"},{"conditions": {"options": {"caseSensitive": true,"leftValue": "","typeValidation": "strict","version": 2},"conditions": [{"id": "3b61a64f-0a4d-4f8e-8836-ec9eb89cdcbb","leftValue": "generating","rightValue": "={{ $json.data.state }}","operator": {"type": "string","operation": "equals"}}],"combinator": "and","renameOutput": true,"outputKey": "in progress"}]},"options": {"fallbackOutput": "extra"}},"type": "n8n-nodes-base.switch","typeVersion": 3.3,"position": [3344, 292],"id": "3472f12a-f07f-4184-b367-2b866722dbfd","name": "Switch"},{"parameters": {"method": "POST","url": "https://queue.fal.run/fal-ai/ffmpeg-api/merge-audio-video","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","sendBody": true,"bodyParameters": {"parameters": [{"name": "video_url","value": "={{ $json.data.resultJson.parseJson().resultUrls[0] }}"},{"name": "audio_url","value": "={{ $('HTTP Request14').item.json.audio.url }}"}]},"options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [3568, 308],"id": "2ca31bdf-31b6-4f12-8700-e0cc28d805b3","name": "HTTP Request16","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {},"type": "n8n-nodes-base.wait","typeVersion": 1.1,"position": [3792, 308],"id": "4de20535-bbea-415f-a6ed-6e2c5fec2c9c","name": "Wait8","webhookId": "80244780-c89d-4eb2-b367-66d848d9fcd2"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}/status ","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [4016, 236],"id": "48101eb8-d9d5-402f-a562-9de158d3c7e6","name": "HTTP Request17","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"conditions": {"options": {"caseSensitive": true,"leftValue": "","typeValidation": "strict","version": 2},"conditions": [{"id": "34aa2d18-8f01-404d-8bd4-5299704f1729","leftValue": "={{ $json.status }}","rightValue": "COMPLETED","operator": {"type": "string","operation": "equals","name": "filter.operator.equals"}}],"combinator": "and"},"options": {}},"type": "n8n-nodes-base.if","typeVersion": 2.2,"position": [4240, 308],"id": "2ebd0463-f027-4dbd-9b45-4a216156b5aa","name": "If1"},{"parameters": {"url": "=https://queue.fal.run/fal-ai/ffmpeg-api/requests/{{ $json.request_id }}","authentication": "genericCredentialType","genericAuthType": "httpHeaderAuth","options": {}},"type": "n8n-nodes-base.httpRequest","typeVersion": 4.2,"position": [4464, 308],"id": "974dd54d-d37c-4e52-930c-b33a75ccdcd2","name": "HTTP Request18","credentials": {"httpHeaderAuth": {"id": "kjP3wI9wUnFwg9EG","name": "Fai.ai"}}},{"parameters": {"promptType": "define","text": "=scene_title {{ $('Loop Over Items1').item.json.scene_title }}\nscene_description {{ $('Loop Over Items1').item.json.scene_description }}\nvoice_over {{ $('Loop Over Items1').item.json.text }}","options": {"systemMessage": "=You are a video generation prompt creator. Analyze the scene and create a concise prompt (max 100 words) for video generation.\n\nProcess:\n1. Read the scene_title, scene_description, and text\n2. Identify the story's cultural/geographical context from the content\n3. Select appropriate visual style based on that context (e.g., Japanese anime for Tokyo stories, Western cinematic for NYC stories, etc.)\n4. Generate a focused prompt with: visual style, key actions, mood, lighting, camera angle\n\nFormat your output as a single paragraph prompt ready for video generation tools.\n\nInput:\n- Scene Title: {scene_title}\n- Scene Description: {scene_description}\n- Text/Dialogue: {text}\n{\n  \"model\": \"kling/v2-5-turbo-text-to-video-pro\",\n  \"input\": {\n    \"prompt\": \"professional air-conditioning technician cleaning an AC unit, add subtle text at bottom: 'PA Cooling 084-282-4465', cinematic lighting, clean background\",\n    \"duration\": \"10\",\n    \"aspect_ratio\": \"16:9\",\n    \"cfg_scale\": 0.5\n  }\n}\n\nOutput only the video generation prompt, nothing else."}},"type": "@n8n/n8n-nodes-langchain.agent","typeVersion": 2.2,"position": [2320, 308],"id": "f7eea95c-ca62-4541-bb22-72f7d9985df0","name": "AI Agent2"},{"parameters": {"model": "google/gemini-2.5-pro","options": {}},"type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter","typeVersion": 1,"position": [2392, 532],"id": "65eed84f-9e01-4d4c-bb31-94a4d322afb9","name": "OpenRouter Chat Model2","credentials": {"openRouterApi": {"id": "HV2qWrOpeWPxQ61y","name": "OpenRouter account 2"}}},{"parameters": {"promptType": "define","text": "ผมจะทำให้เป็นภาษาที่อ่านง่าย ดูน่าเชื่อถือ และเหมาะกับงานบริการจริง ๆ\n\n\n---\n\n?? บริการงานแอร์ ตู้แช่ และห้องเย็น ครบวงจร\n\nบริการโดยช่างมืออาชีพ ประสบการณ์กว่า [x] ปี\nเราพร้อมดูแลทุกงานเกี่ยวกับระบบทำความเย็น ตั้งแต่บ้านพักอาศัย ร้านค้า ไปจนถึงโรงงานอุตสาหกรรม\n\n?? บริการของเรา\n\n? งานแอร์\n\nติดตั้งแอร์บ้าน / สำนักงาน\n\nล้างแอร์ เติมน้ำยา ตรวจเช็กระบบไฟ\n\nซ่อมแอร์ทุกยี่ห้อ ทุกอาการเสีย\n\nย้ายจุดติดตั้งและเดินท่อใหม่\n\n\n? งานตู้แช่\n\nติดตั้งและซ่อมตู้แช่เย็น / ตู้แช่แข็ง\n\nเปลี่ยนคอมเพรสเซอร์ และอะไหล่มาตรฐาน\n\nตรวจสอบระบบน้ำยาและท่อแอร์\n\n\n? งานห้องเย็น\n\nรับออกแบบ ติดตั้งห้องเย็นตามขนาดที่ต้องการ\n\nระบบควบคุมอุณหภูมิอัตโนมัติ\n\nซ่อมแซมและบำรุงรักษาระบบห้องเย็น\n\nเหมาะสำหรับร้านอาหาร โรงงาน และเกษตรแปรรูป\n\n\n?? จุดเด่นของเรา\n\nทีมช่างมืออาชีพ ผ่านการอบรมด้านระบบความเย็นโดยเฉพาะ\n\nใช้อะไหล่แท้ รับประกันคุณภาพทุกงาน\n\nบริการรวดเร็ว ราคายุติธรรม\n\nมีบริการตรวจเช็กและดูแลรายเดือน\n\n\n?? ติดต่อเราได้ที่:\nโทร: [เบอร์โทรของคุณ]\nLINE: [ไลน์ไอดี]\nFacebook: [เพจของคุณ]\nเปิดบริการทุกวัน ตั้งแต่ 08.00 – 23.00 น.\n\n\n---\n\nคุณอยากให้ผมช่วยต่อยอดแบบไหนครับ? เช่น\n\nเขียนให้เหมาะกับ หน้าเว็บไซต์บริษัท\n\nเขียนให้เหมาะกับ โพสต์โฆษณา Facebook / TikTok\n\nหรือให้เป็น สคริปต์พูดแนะนำบริการ\n\n\nจะได้ช่วยจัดรูปแบบและโทนภาษาให้เหมาะสมยิ่งขึ้นครับ ??\n\n\n\n084-282-4465 admin@paaair.com @paairservice 14/255 หมู่ 8 ต.บางโฉลง อ.บางพลี สมุทรปราการ","batching": {}},"type": "@n8n/n8n-nodes-langchain.chainLlm","typeVersion": 1.7,"position": [-176, 308],"id": "d07f23ba-9058-4d2c-a148-7a500c206bf2","name": "สร้างเนื้อเรื่อง"},{"parameters": {"operation": "appendOrUpdate","documentId": {"__rl": true,"value": "1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk","mode": "list","cachedResultName": "สำเนาของ n8n animation production PAA","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit?usp=drivesdk"},"sheetName": {"__rl": true,"value": 113471321,"mode": "list","cachedResultName": "Sheet1","cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sbIKza7wlss7hmVqhIh8Wo0iyzZQI16bJ7AaqR7IROk/edit#gid=113471321"},"columns": {"mappingMode": "defineBelow","value": {"video": "={{ $('HTTP Request15').item.json.data.resultJson.parseJson().resultUrls[0] }}","status": "pending","video_audio": "={{ $json.video.url }}","audio": "={{ $('HTTP Request14').item.json.audio.url }}","title": "={{ $('Split Out1').item.json.scene_title }}","desciption ": "={{ $('Split Out1').item.json.scene_description }}"},"matchingColumns": ["audio"],"schema": [{"id": "audio","displayName": "audio","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "video","displayName": "video","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "video_audio","displayName": "video_audio","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "status","displayName": "status","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "title","displayName": "title","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "desciption ","displayName": "desciption ","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false},{"id": "Final","displayName": "Final","required": false,"defaultMatch": false,"display": true,"type": "string","canBeUsedToMatch": true,"removed": false}]},"attemptToConvertTypes": false,"convertFieldsToString": false},"options": {}},"type": "n8n-nodes-base.googleSheets","typeVersion": 4.7,"position": [2096, 308],"id": "5abbe36f-5b8c-4618-a4f9-6ceb8d942086","name": "Append row in sheet1","credentials": {"googleSheetsOAuth2Api": {"id": "tJDzYUzM2DzwU6Fo","name": "Google Sheets account"}}}]}